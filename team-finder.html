<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>I just want to play Volleyball</title>
    <link rel="icon"
          type="image/png"
          href="http://static.wixstatic.com/media/1f7ec8_ba4d603f2e0147cfb9725c6bb22600cd.png_srz_42_43_85_22_0.50_1.20_0.00_png_srz">

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/github-dark.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    
    <link href="css/style.css" rel='stylesheet' type='text/css' />
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<link
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css"
	rel="stylesheet" />
<script
	src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css" />
<script
	src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
	<script src='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.js'></script>
	<link href='https://api.mapbox.com/mapbox.js/v2.2.3/mapbox.css' rel='stylesheet' />
	<style>
	.gmnoprint img {
		max-width: none;
	}
	
	.panel:hover {
		background-color: rgb(237, 245, 252);
	}
	
	.map {
		min-width: 300px;
		min-height: 470px;
		width: 100%;
		height: 100%;
	}
	
	img {
		max-width: 110%;
		height: auto;
	}
	
	.clearfix {
		clear: both;
	}
	
	.rowcolor {
		background-color: #CCCCCC;
	}
	
	.padall {
		padding: 4px;
	}
	.panel-body {
		padding: 4px;
	}
	
	.row {
    		margin-right: -10px;
    		margin-left: -10px;
	}
	.icon {
		font-size: 23px;
		color: #197BB5;
	}
	</style>
  </head>
  <body style="background-color: rgb(108, 121, 137);">
    <div class="wrapper" style="width: 90%">
      <header class="without-description">
        <h1>Let's find a Club to play Volleyball</h1>
        <h0>--{ Work in Progress }--</h0>
        <p></p>
        <p class="view"><a href="./index.html">Find a <br> court</a></p>
        <p class="view"><a href="./about.html">About this page</a></p>
        <ul>
          <!--li><a href="https://github.com/latibbean/get-my-a-gym/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/latibbean/get-my-a-gym/tarball/master">Download <strong>TAR Ball</strong></a></li-->
          <li><a href="./index.html">Find a  <br> court</a></li>
          <li><a href="./about.html">About <br>this page</a></li>
        </ul>
      </header>
      <section>

<div class="container" id="gym" style="max-height: 800px; margin-right: 10px; margin-left: 10px; display: table-row">

<div class="row padbig">

<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
<div class="row">
<div id="map" class="map" style="min-height: 600px"></div>
</div>
</div>

<div style="text-align: center">
	<div class="panel panel-primary" style="display: table; margin-top: 10px">
		<div class="panel-heading">
			<h3 class="panel-title">Find your Team</h3>
		</div>
		<div class="panel-body">
			<div class="btn-group padall" data-toggle="buttons">
		  		<label class="btn btn-primary btn-filter active">
		    		<input class="btn-filter" type="checkbox" autocomplete="off" id="rdIndoor" checked="true"> Indoor
		  		</label>
		  		<label class="btn btn-primary btn-filter">
		    		<input class="btn-filter" type="checkbox" autocomplete="off" id="rdBeach"> Beach
		  		</label>
			</div>
			<div class="btn-group padall" data-toggle="buttons">
		  		<label class="btn btn-primary btn-filter active">
		    		<input type="checkbox" autocomplete="off" id="rdMen" checked="true"> Men
		  		</label>
		  		<label class="btn btn-primary btn-filter">
		    		<input  type="checkbox" autocomplete="off" id="rdWomen"> Women
		  		</label>
		  		<label class="btn btn-primary btn-filter">
		    		<input type="checkbox" autocomplete="off" id="rdMixed"> Mixed
		  		</label>
			</div>
			<div class="btn-group padall" data-toggle="buttons">
		  		<label class="btn btn-primary btn-filter">
		    		<input class="btn-filter" type="checkbox" autocomplete="off" id="rdNational"> National
		  		</label>
		  		<label class="btn btn-primary btn-filter">
		    		<input class="btn-filter" type="checkbox" autocomplete="off" id="rdPremier"> Premier
		  		</label>
		  		<label class="btn btn-primary btn-filter active">
		    		<input class="btn-filter" type="checkbox" autocomplete="off" id="rdDiv1" checked="true"> Div 1
		  		</label>
		  		<label class="btn btn-primary btn-filter">
		    		<input class="btn-filter" type="checkbox" autocomplete="off" id="rdDiv2"> Div 2
		  		</label>
		  		<label class="btn btn-primary btn-filter">
		    		<input class="btn-filter" type="checkbox" autocomplete="off" id="rdSocial"> Social
		  		</label>
			</div>	

			<div  class="padall">
				<div class="btn-group btn-filter " data-toggle="buttons">
			  		<label class="btn btn-primary btn-filter active">
			    		<input class="btn-filter" type="checkbox" autocomplete="off"  checked="true" id="rdMonday"> Mon
			  		</label>
			  		<label class="btn btn-primary btn-filter active">
			    		<input class="btn-filter" type="checkbox" autocomplete="off" checked="true" id="rdTuesday"> Tue
			  		</label>
			  		<label class="btn btn-primary btn-filter active">
			    		<input class="btn-filter" type="checkbox" autocomplete="off" checked="true" id="rdWednesday"> Wed
			  		</label>
			  		<label class="btn btn-primary btn-filter active">
			    		<input class="btn-filter" type="checkbox" autocomplete="off" checked="true" id="rdThursday"> Thur
			  		</label>
			  		<label class="btn btn-primary btn-filter active">
			    		<input class="btn-filter" type="checkbox" autocomplete="off" checked="true" id="rdFriday"> Fri
			  		</label>
			  		<label class="btn btn-primary btn-filter active">
			    		<input class="btn-filter" type="checkbox" autocomplete="off" checked="true" id="rdSaturday"> Sat
			  		</label>
			  		<label class="btn btn-primary btn-filter active">
			    		<input class="btn-filter" type="checkbox" autocomplete="off" checked="true" id="rdSunday"> Sun
			  		</label>
				</div>	
		</div>
	
			<div  class="padall">
					<div class="btn-group padbig" data-toggle="buttons">
						<button type="button" id="resetButton" data-loading-text="Loading..." class="btn btn-primary" autocomplete="off">Apply filter and reset Map</button>
					</div>
			</div>	
	</div>
</div>
<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 "
	style="overflow: scroll; max-height: 357px; margin-bottom: 5%" id="ListOfGyms"></div>

</div>
</div>

<script>
    $('#resetButton').click(function () {
        console.log('reset map zoom');
        var latLondon  = 51.5286416;
        var lngLondon  = -0.1015987;
        map.setView((new L.LatLng(latLondon, lngLondon)), 11);
		resetMap();
    });


	$('.btn-filter').click(function () {
		$(this).toggleClass('active-checked'); 
        console.log('reset class filter');

        
        console.log('Beach checked: ' + $('#rdBeach').prop('checked'));
        console.log('Indoor checked: ' + $('#rdIndoor').prop('checked'));
        
        console.log('Beach active-checked: ' + $('#rdBeach').parent().hasClass('active-checked'));
        console.log('Indoor active-checked: ' + $('#rdIndoor').parent().hasClass('active-checked'));
        
		resetMap();

	  });
        
    </script>


<script src="https://maps.google.com/maps/api/js?sensor=false"></script>

<script type="text/javascript">
	var latLondon = 51.5286416;
	var lngLondon = -0.1015987;
	var myLondonLocation = new google.maps.LatLng(latLondon, lngLondon);

	var map = L.map('map').setView( [ latLondon, lngLondon ], 11);
	var volleyIcon = L.icon( {
		//            iconUrl: 'images/marker1.png',
		iconUrl : 'images/indoorvb2.png',
		//shadowUrl: 'leaf-shadow.png',
		//iconSize:     [38, 95], // size of the icon
		//shadowSize:   [50, 64], // size of the shadow
		//iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
		//shadowAnchor: [4, 62],  // the same for the shadow
		popupAnchor : [ 10, -5 ]
	// point from which the popup should open relative to the iconAnchor
			});

	var volleyBeachIcon = L.icon( {
		//          iconUrl: 'images/marker1.png',
		iconUrl : 'images/vls3001_PvZ_icon.ico',
		//shadowUrl: 'leaf-shadow.png',
		//iconSize:     [38, 95], // size of the icon
		//shadowSize:   [50, 64], // size of the shadow
		//iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
		//shadowAnchor: [4, 62],  // the same for the shadow
		popupAnchor : [ 10, -5 ]
	// point from which the popup should open relative to the iconAnchor
			});

	var mGymsInList = [];

        L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
            maxZoom: 18,
            attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, ' +
            '<a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, ' +
            'Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
            id: 'latibbean.lgg1j91f',
            accessToken: 'pk.eyJ1IjoibGF0aWJiZWFuIiwiYSI6IlgtVWVKWXcifQ.1pwTsR0qN4DqOZHciOUFdA'
        }).addTo(map);

	var markers = new L.FeatureGroup();

	var myData;
	$.getJSON("gyms.json", function(data) {
		//Do nothing here?
		}).done(function(data) {
		// data is a JavaScript object now. Handle it as such
			function compareGymName(a, b) {
				if (a.Gym < b.Gym)
					return -1;
				if (a.Gym > b.Gym)
					return 1;
				return 0;
			}
			data.sort(compareGymName);
			myData = data;
			resetMap();
		});

	function resetMap() {
		data = myData;
		$("#ListOfGyms").empty();
		mGymsInList = [];

		map.removeLayer(markers);
		markers.clearLayers();
    	 $.each( data, function( i, item ) {
 			if (item.Court=='Beach') {
 				if ($('#rdBeach').prop('checked')==true) {
 					var lMarker = L.marker([item.latitude, item.longitude], {icon:volleyBeachIcon}) //.addTo(map)
             			.bindPopup("<b>" + item.Gym + "</b><br />Address: " + item.Address + ",  " + item.PostCode + "<br/>Court: " + item.Court + "<br/><br/>" + item.Info); 
 	        		markers.addLayer(lMarker);
 	    			addGymToPage(item, i);           
 		        }
 			} else if (item.Court=='Indoor') {
 				if ($('#rdIndoor').prop('checked')==true) {
 					var lMarker = L.marker([item.latitude, item.longitude], {icon:volleyIcon}) //.addTo(map)
         				.bindPopup("<b>" + item.Gym + "</b><br />Address: " + item.Address + ",  " + item.PostCode + "<br/>Court: " + item.Court + "<br/><br/>" + item.Info); 
 					markers.addLayer(lMarker);
 	 	    		addGymToPage(item, i);           
      			}
 			}
       	});

		map.addLayer(markers);

		function addGymToPage(iGym, i) {
			if ($.inArray(iGym.Gym, mGymsInList) >= 0) {
				return;
			} else {
				mGymsInList.push(iGym.Gym);

			$("#ListOfGyms").append("<div>");
 	            var $lGymLine = $("#ListOfGyms div").last();
 	            $lGymLine.attr("id", iGym.Gym + "_1").addClass("col-xs-12").addClass("col-sm-12").addClass("col-md-12 col-lg-12");
 	            
 	            
 	            $lGymLine.append("<div>")
 	            var $lGymPanel = $("#ListOfGyms div").last();
 	            //console.log($lGymPanel);
 	            $lGymPanel.attr("id", iGym.Gym + "_2").addClass("panel").addClass("panel-default");
				$lGymPanel.bind("click", function() {
					//alert( "User clicked on: " + iGym.gym);
						// 	                init_map_adress(iGym.Address);

						map.setView(
								(new L.LatLng(iGym.latitude, iGym.longitude)),
								15);
						// 					map.panTo(new L.LatLng(iGym.latitude, iGym.longitude));
						// 					map.options.zoom = 2;
						// 					map.options.maxZoom = 2;
						//map.setView([iGym.latitude, iGym.longitude], 10);
						$("#map").focus();
					});

				 	            $lGymPanel.append("<div>");
 	            var $lGymPanelSub =  $("#ListOfGyms div").last().attr("id", iGym.Gym + "_3").addClass("row").addClass("padall");
 	
 	            $lGymPanelSub.append("<div>");
 	            var $lGymPanelSub2 = $("#ListOfGyms div").last().attr("id", iGym.Gym + "_4").addClass("col-xs-12").addClass("col-sm-12").addClass("col-md-12").addClass("col-lg-12");
 	
 	            $lGymPanelSub2.append("<div>");
 	            var $lGymPanel21 = $("#ListOfGyms div").last().attr("id", iGym.Gym + "_5").addClass("clearfix").append("<div>");//.addClass("pull-left");
 	
 	            // Adding Name
 	            $lGymPanel21.append("<span>");
 	            $("#ListOfGyms div").last().addClass("icon").text(iGym.Gym);
 	
 	            //Adding PostCode
 	            $lGymPanel21.append("<div>");
 	            $("#ListOfGyms div").last().addClass("pull-left").text(iGym.PostCode);

 	            //Adding Area
 	            $lGymPanel21.append("<div>");
 	            $("#ListOfGyms div").last().addClass("pull-right").text(iGym.Area);
			}
		}
		map.invalidateSize();
	}
</script>
      </section>
    </div>
    <footer>
      <p>Project maintained by David Urena</p>
      <p>Hosted on GitHub Pages</p>
    </footer>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>
